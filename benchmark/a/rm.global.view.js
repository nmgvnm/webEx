/*!
 *
 * RemoteMeeting
 *
 * IMPORTANT NOTE: This file is licensed only for use in providing the RSUPPORT services.
 *
 * @license Copyright (c) RSUPPORT CO., LTD. (http://www.rsupport.com/)
 * @author Front-End Team | Jeong Shik Park (jspark@rsupport.com)
 * @author Front-End Team | HEE JIN SHIN (hjshin@rsupport.com)
 * @author Front-End Team | U Chang Heo (ucheo@rsupport.com)
 *
 */
!function(e){"use strict";function n(n){var o=n,r=o.val(),c=o.parents(".form-item-wrap"),s=c.find("em");o.data("emailValue");s.length&&s.remove();var l=function(n){"40100"===n.returnCode?(o.data({emailValue:r,emailPass:!0}),a.insertMsgHtml(c,"success custom",n.resultMsg||e.i18n.RM00674),a.user.email=r):(o.removeClass("valid").addClass("error"),a.insertMsgHtml(c,"error custom",n.message),i.ga&&i.ga.send("Home>account>agree","join-trial-bottom-fail-email",n.message))};o.valid()&&t(o,r,l)}function t(e,n,t){e.data({emailValue:"",emailPass:!1}),i.request({action:"/account/exist-email",method:"get",params:{email:n},success:t})}console.info("rm.validation.js loaded.");var a=window.rm,i=a.api,o=a.conference,r=e("form"),c=a.pathName,s=a.user.isLogined;e.validator.addMethod("accessCodeRegex",function(e,n,t){var a=e;return 7===a.length&&3===a.indexOf(" ")&&(a=a.split(" "),a=a.join(""),a=a.toString()),this.optional(n)||/[0-9]{6}/.test(a)}),e.validator.addMethod("idRegex",function(e,n,t){return this.optional(n)||/^[0-9a-z]{4,24}$/.test(e)}),e.validator.addMethod("emailRegex",function(e,n,t){return this.optional(n)||/^[-A-Za-z0-9_]+[-A-Za-z0-9_.]*[@]{1}[-A-Za-z0-9_]+[-A-Za-z0-9_.]*[.]{1}[A-Za-z]{2,5}$/.test(e)}),e.validator.addMethod("passwordRegex",function(e,n,t){if(a.user.email!==e)return this.optional(n)||/^(?=.*[a-zA-Z])(?=.*[0-9]).{8,24}$/.test(e)}),e.validator.addMethod("variablePhone",function(e,n,t){return this.optional(n)||/^[0-9+-]{1,20}$/.test(e)}),e.validator.addMethod("blockXSSChar",function(e,n,t){return this.optional(n)||!/[\/:?*<>"|&\\%+;']/.test(e)}),e.validator.addMethod("blockXSSCharLite",function(e,n,t){return this.optional(n)||!/[<>;]/.test(e)}),e.validator.addMethod("agreeChecked",function(n,t,a){return e(t).prop("checked")}),e.validator.addMethod("landingAgreeChecked",function(n,t,a){return e("#check-terms").prop("checked")&&e("#check-privacy").prop("checked")}),e.validator.addMethod("landingAgreeCheckedTerm",function(n,t,a){return e("#check-terms").prop("checked")}),e.validator.addMethod("landingAgreeCheckedPrivacy",function(n,t,a){return e("#check-privacy").prop("checked")}),e.validator.addMethod("filename",function(e,n){var t=n.files[0].name.split(".");return t.splice(t.length-1,1),t=t.join("."),!e||t.length<51},e.i18n.RMA00804),e.extend(e.validator.messages,{required:e.i18n.RM00051,blockXSSChar:e.i18n.RM00696+"\\ / : ? * < > \" | & % + ; ' ",blockXSSCharLite:e.i18n.RM00696+"< > ; ",maxlength:e.i18n.RMB0332,number:e.i18n.RM00455,equalTo:e.i18n.RM00560,variablePhone:e.i18n.RM00431,emailRegex:e.i18n.RM00049,passwordRegex:e.i18n.RM00561,accessCodeRegex:e.i18n.RM00068,agreeChecked:e.i18n.RM00544,landingAgreeChecked:e.i18n.RM00544,landingAgreeCheckedTerm:e.i18n.RM00544,landingAgreeCheckedPrivacy:e.i18n.RM00544});var l=function(){var t={replaceXSSChar:"",reqDataType:"",rules:{},submitHandler:null};return c.match("/account/agree")&&(t={invalidHandler:function(e,n){var t={"check-policy":"agree-fail"};i.ga&&i.ga.registerInvalidGa("Home>account>agree",t,n.invalid)},rules:{country:{required:!0},"check-policy":{agreeChecked:!0}}}),(c.match("/landing/do-remotemeeting")||c.match(a.lang+"/home"))&&(t={rules:{email:{required:!0,maxlength:50,emailRegex:!0},userName:{required:!0,maxlength:50,blockXSSChar:!0},companyName:{required:!0,maxlength:100,blockXSSChar:!0},phone:{required:!0,variablePhone:!0},"check-privacy":{landingAgreeCheckedPrivacy:!0},"check-terms":{landingAgreeCheckedTerm:!0}},submitHandler:function(n){var t="/landing/user-join"===n.getAttribute("action"),a=e("#email-check-input"),i=a.data("emailPass");if(console.log("*****checked value",t,i),t&&!i)return alert(e.i18n.RMB0366),a.focus(),!1}},c.match("/landing/do-remotemeeting")&&(t.invalidHandler=function(e,n){console.log("****validate error",n);var t={companyName:"join-trial-bottom-fail-company",userName:"join-trial-bottom-fail-name",phone:"join-trial-bottom-fail-telephone",email:"join-trial-bottom-fail-email","check-terms":"join-trial-bottom-fail-checkbox"};i.ga&&i.ga.registerInvalidGa("Landing",t,n.invalid)}),e("#email-check-input").on("blur",function(){var t=e(this);setTimeout(function(){n(t)},200)})),c.match("/account/join")&&-1===c.indexOf("-")&&(t={invalidHandler:function(e,n){console.log("****validate error",n);var t={username:"submit-fail-username",password:"submit-fail-password",confirmPassword:"submit-fail-password",name:"submit-fail-name",department:"submit-fail-department",customerName:"submit-fail-customerName",phone:"submit-fail-phone"};i.ga&&i.ga.registerInvalidGa("Home>account>join",t,n.invalid)},rules:{username:{required:!0,maxlength:50,emailRegex:!0},password:{required:!0,passwordRegex:!0},confirmPassword:{required:!0,equalTo:"#password"},name:{required:!0,maxlength:50,blockXSSChar:!0},department:{required:!0,maxlength:50,blockXSSChar:!0},timeZone:{required:!0},customerName:{required:!0,maxlength:100,blockXSSChar:!0},phone:{required:!0,variablePhone:!0}},submitHandler:function(n){var t=e("#email-check-input"),a="/account/join"===n.getAttribute("action"),i=t.data("emailPass");if(a&&!i)return alert(e.i18n.RMB0366),t.focus(),!1}},e("#email-check-input").on("blur",function(){n(e(this))})),c.match("/account/user-invite")&&(t={rules:{password:{required:!0,passwordRegex:!0},confirmPassword:{required:!0,equalTo:"#password"},groupAdministratorName:{required:!0,maxlength:100,blockXSSChar:!0},"check-policy":{agreeChecked:!0}}}),c.match("/account/password-find")&&(t={rules:{email:{required:!0,emailRegex:!0,maxlength:50}}}),c.match("/account/password-change")&&(t={rules:{password:{required:!0,passwordRegex:!0},confirmPassword:{required:!0,equalTo:"#password"}}}),t.rules.accessCode={accessCodeRegex:!0},t}(),d=l.invalidHandler?l.invalidHandler:function(e,n){};e.validator.setDefaults({debug:!0,onsubmit:!0,invalidHandler:d,rules:l.rules?l.rules:{},errorElement:"em",errorPlacement:function(n,t){"email-check-input"===t.attr("id")&&t.hasClass("error")&&e("#email-check-input-error.success").remove(),t.parents(".form-item-wrap").append(n)},success:function(e){},error:function(e){},messages:{accessCode:{required:e.i18n.RM00067},j_username:{required:e.i18n.RM00537},j_password:{required:e.i18n.RM00538}},submitHandler:function(n){if(console.info("validation submitHandler",arguments),l.submitHandler){var t=l.submitHandler(n);if("boolean"==typeof t)return t}var a=e(n),o={reqDataType:l.reqDataType,replaceXSSChar:l.replaceXSSChar};return i.submit(a,o),!1}}),window.checkOverlapEmail=t,function(){console.log("initValidation",arguments,r),r.each(function(){var n=e(this),t=n.get(0).getAttribute("data-validation-type"),r=n.get(0).getAttribute("data-conference");if("alert"===t)n.validate({onfocusin:!1,onfocusout:!1,onkeyup:!1,onclick:!1,errorPlacement:function(){},invalidHandler:function(t,a){if(a.numberOfInvalids()&&(alert(a.errorList[0].message),a.errorList[0].element.focus()),"joinmeeting-submit"===e.trim(n.attr("data-ga-action"))){var o=s?"LoginUser":"GuestUser";i.ga&&i.ga.send("Home>main","joinmeeting-submit",o+" / "+JSON.stringify(a.invalid))}}});else{if("none"===t)return!0;n.validate()}"license-join-direct"!==r&&"free-join"!==r||(n.data("validator").settings.submitHandler=function(n){if(console.log("Conference submitHandler"),a.util.checkBrowser())return o.search(e(n),r),!1})})}()}(jQuery),function(e){function n(){var n=e("#header .gnb ul"),t=e("#footer .sitemap ul"),a=e(".page-support-guide .side-nav ul"),i=e(".header-item.gnb-user .menu");n.find("> li a").each(function(){M.match(e(this).attr("href"))&&e(this).parents("li").addClass("on")}),t.find("> li a").each(function(){M.match(e(this).attr("href"))&&e(this).parents("li").addClass("on")}),a&&a.find("> li a").each(function(){M.match(e(this).attr("href"))&&e(this).parents("li").addClass("on")}),i&&i.find("> li a").each(function(){M.match(e(this).attr("href"))&&e(this).parents("li").addClass("on")})}function t(n){h.request({action:"/user/connect/GOOGLE",method:"post",params:{accessToken:n},success:function(n){console.log("google connect",n),"40100"===n.returnCode?(O.attr("data-connected","connected"),alert(e.i18n.RMB0867)):alert(n.message)}})}function a(){h.request({action:"/user/disconnect/GOOGLE",method:"post",success:function(n){console.log("google disconnect",n),"40100"===n.returnCode?(O.attr("data-connected","disconnected"),alert(e.i18n.RMB0869)):alert(n.message)}})}function i(){var n=function(n,t,a){var i=function(i){var o=i.returnCode;console.log("여기 email",n,o),"40100"===o?(B.data({emailValue:n,emailPass:!0}),f.user.email=n,e(".form-item-wrap.email").find("em").remove(),r(n,t,a),B.removeClass("error").addClass("valid").blur()):"40811"===o?(alert(e.i18n.RMB0865),B.removeClass("valid").addClass("error")):(alert(i.message),B.removeClass("valid").addClass("error"))};checkOverlapEmail(B,n,i)};P.getGoogleInfo(n)}function o(){N.val("").attr("readonly",!1),B.val("").removeClass("valid error").attr("readonly",!1).focus(),L.attr("data-connected","disconnected"),e('input[name="accessToken"]').length&&(e('input[name="accessToken"]').remove(),e('input[name="idp"]').remove())}function r(n,t,a){B.val(n).attr("readonly",!0),N.val(t).attr("readonly",!0),L.attr("data-connected","connected"),e('input[name="accessToken"]').length?(e('input[name="accessToken"]').val(a),e('input[name="idp"]').val("GOOGLE")):T.prepend('<input type="hidden" value="'+a+'" name="accessToken" /><input type="hidden" name="idp" value="GOOGLE" />')}function c(){var n=f.util.detect.browser,t=y.find(".form-login form"),a=e("[data-conference], .live-demo, .chatbot-popup");if(q){if(e("#box-promotion").length){var i=e("#box-promotion"),o=e("#box-promotion").html(),r=i.find("area").attr("href");e("#box-promotion").html('<a href="'+r+'" target="_blank">'+o+"</a>")}w.attr("data-device","mobile"),a.off().on("submit click",function(){return e.dialog("/contents/dialogs/need-download-mobile-app",function(){p.setIosUrl()}),!1})}else w.addClass("is-pc"),x&&w.addClass("is-win-xp"),S&&w.addClass("is-win-vista"),n.isSupportedRM?w.addClass("is-support-browser"):(console.log("미지원 브라우저",n),w.addClass(n.name.toLowerCase()),w.addClass("is-not-support-browser"),w.attr("data-is-support-browser","false"),a.off().on("submit click",function(){return f.util.checkBrowser(function(){a.focusout(),a.find("input:text").val("")})}),t.off().on("submit click",function(){return f.util.checkBrowser()}))}function s(){var n=new DeviceSetting({isLounge:!0,getStorage:p.localStorage.get,setStorage:p.localStorage.set,submit:function(){n.save()}});e("#device-setting-btn").on("click",function(){return n.open(),!1}),q&&e("#device-settings").remove()}function l(){var n=new ConnectionChecker({conference:v,emitter:k});e("#webrtc-test").on("click",function(){return n.open(),!1})}function d(){var n=e(".photo-box img"),t=p.timestamp.now(),a=n.attr("src")+"?"+t;n.attr("src",a)}function u(n){console.log("setFirebase",arguments),f.firebaseClient=new FirebaseClient({name:n.name,email:n.email,apiDomain:f.apiDomain,onMessage:function(n){console.log("firebase data",n),e.notification(n.notificationType,n,R)}})}function m(){C.bind("click",function(n){var t=e(n.target),a=t.closest(".header-item");"none"!==I.css("display")&&I.parents(".gnb").removeClass("is-open"),"none"===z.css("display")||a.hasClass("gnb-user")||z.parent(".gnb-user").removeClass("is-open"),"none"===$.css("display")||a.hasClass("rview-account")||U.removeClass("open"),"none"!==Q.css("display")&&Q.toggle()})}function g(){e(".chatbot-popup").on("click",function(n){var t=n.target,a=t.getAttribute("data-ga-category"),i=t.getAttribute("data-ga-action");H&&H.send(a,i,""),e.dialog("/contents/dialogs/create-live-meeting",null,"white-box")})}console.info("rm.view.global.js loaded.",e('[data-conference*="url"]').length);var f=window.rm,p=f.util,h=f.api,v=f.conference,b=f.user,k=f.emitter,C=f.$doc,w=f.$body,y=f.$header,M=f.pathName,R=f.lang,x=f.isWinXP,S=f.isWinVista,q=f.isMobile,A=f.isSolution,j={countryCode:f.countryCode,isSolution:A},H=new MeetingGA(j),P=new OAuth(f.googleClientId),T=e("#account-join"),O=e("#google-oauth-connection"),L=e("#google-join"),B=T.find("#email-check-input"),N=T.find("#name");if(H.isActive||(H=null),e("#partnerId").length>0){var X="ko"===R?"KOREA":"JAPAN";e.getJSON("/landing/partner-list?branchCode="+X,function(n){"40100"===n.returnCode&&n.returnData.forEach(function(n){var t=e("<option></option>");t.text(n.label),t.val(n.value),e("#partnerId").append(t)})})}w.on("click",".live-demo[data-action=create-live-demo]",function(e){console.log("데모시작");var n=e.target,t=n.getAttribute("data-ga-category"),a=n.getAttribute("data-ga-action");H&&H.send(t,a,""),v.createLiveMeeting()}),e('[data-conference*="create"]').on("click",function(){var n=e(this);return p.checkBrowser()?(n.attr("data-conference").match("enterprise")?e.dialog("/contents/dialogs/session/channel-join",function(){var n=e("#dialog"),t=n.find("form"),a=t.find('input[name="title"]'),i=n.find("#video-quality-wrap");i.find("input").click(function(){e(this).parent().addClass("active").siblings().removeClass("active")}),n.find(".radio-wraps input").click(function(){var n=e(this).val();i["video"===n?"slideDown":"slideUp"]("fast")}),p.preventInputMaxLength(a),t.validate({onfocusin:!1,onfocusout:!1,onclick:!1,onkeyup:!1,rules:{title:{required:{depends:function(n){return e(n).attr("value",e.trim(e(n).val())),!0}},maxlength:50,blockXSSChar:!0},type:{required:!0}},messages:{title:{required:e.i18n.RM00508}},errorPlacement:function(){},invalidHandler:function(e,n){n.numberOfInvalids()&&(alert(n.errorList[0].message),n.errorList[0].element.focus())},submitHandler:function(){var e=t.find('input[name="title"]').val(),n=t.find('input[name="type"]:checked').val(),a=1*t.find("#video-quality-wrap :checked").val();return v.create({title:e,type:n,videoQuality:a}),!1}})},"white-box"):"direct"===n.attr("data-direct")?v.create({title:"Free Conference",type:"video",isDirectOpen:!0}):v.create({title:"Free Conference",type:"video"}),!1):void console.log("checkBrowser 회의 시작")}),e('[data-conference*="url"]').on("click",function(){var n=e(this).attr("data-conference-id"),t=p.getUrlParam().reservationID,a=p.getUrlParam().title;return p.checkBrowser()?(n&&(location.href="/room/"+n),t&&v.conferenceForReservationID(a,t,!0),!1):void console.log("checkBrowser 회의참여하기")});var G=e("#gnb-btn"),I=e("#header .header-item.gnb ul");G.on("click",function(){return I.parents(".header-item.gnb").toggleClass("is-open"),!1}),I.find("a").on("click",function(){I.parents(".header-item.gnb").toggleClass("is-open")});var Z=e(".header-item.gnb .support"),D=Z.find("a");D.mouseenter(function(){Z.toggleClass("is-open")}),D.mouseleave(function(){Z.toggleClass("is-open")});var E=e(".right .header-item.gnb-user"),_=E.find(".btn"),z=E.find(".menu");_.on("click",function(){E.toggleClass("is-open")}),z.find("a").on("click",function(){E.toggleClass("is-open")});var U=e("#rview-account"),$=U.find(".menu");U.find(".wrap-rview-icon").on("click",function(){U.hasClass("account-on")?U.toggleClass("open"):e.dialog("/contents/dialogs/session/rview-account-on",null,"remoteview-box")}),e("[data-btn=disconnect]").on("click",function(){var n=e(this).attr("data-rview-username");e.dialog("/contents/dialogs/session/rview-account-off",function(){e("#connected-username").val(n)},"remoteview-box")}),e("[data-btn=go-remoteview]").on("click",function(){h.moveToRemoteview()});var V=e(".header-item.form-login"),F=V.find("#login-open-btn");V.find("form");F.on("click",function(){return V.toggleClass("is-open"),!1});var J=e("#select-language-btn"),Q=e("#language-selection .lang-list");J.on("click",function(){return Q.toggle(),!1}),Q.find("a").click(function(){J.find("a").html('<span class="current-lang-txt">'+e(this).text()+'</span><i class="rm-icon arrow-col-down-s"></i>'),Q.toggle()}),e('[data-btn="logout"]').on("click",function(e){return h.logout(),!1}),e(".open-with-animation input").on("focus",function(){var n=e(this),t=n.parents("form"),a=n.parents(".btn-join");t.addClass("on"),a.addClass("on")}).on("blur",function(){var n=e(this),t=n.parents("form"),a=n.parents(".btn-join");t.removeClass("on"),a.addClass("on")}),e('[name="accessCode"]').mask("ZZZ ZZZ",{translation:{Z:{pattern:/.*/,optional:!0}},onChange:function(n){var t=f.util.convertTo1ByteChar(n);e('[name="accessCode"]').val(t.replace(/[^0-9\s]/g,""))}}),"CN"!==f.countryCode&&(P.init(),L.click(function(){var e="connected"===L.attr("data-connected");console.log("여기 google join",e),o(),e||i()}),O.click(function(n){if("connected"===O.attr("data-connected"))return confirm(e.i18n.RMB0868)&&a(),!1;gauth.signIn({prompt:"select_account"}).then(function(){var n=gauth.currentUser.get(),a=n.getBasicProfile(),i=a.getName(),o=a.getEmail(),r=n.getAuthResponse().id_token;if(console.log("google infomation",n,a,i,o,r,h),e.trim(o)!==e.trim(e('input[name="email"]').val()))return alert(e.i18n.RMB0866),!1;t(r)})})),function(){console.log("init (global.view)",arguments),e(".dialog").dialog(),w.find("[data-title]").tooltip({targetAttr:"data-title",placement:"bottom"}),n(),c(),m(),g(),s(),l(),d(),A||DetectRTC.browser.isChrome&&b.isLogined&&u(b)}()}(jQuery);
//# sourceMappingURL=rm.global.view.js.map
